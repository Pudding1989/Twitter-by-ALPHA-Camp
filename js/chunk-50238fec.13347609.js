(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50238fec"],{7029:function(t,e,s){},a95e:function(t,e,s){"use strict";s("b570")},b570:function(t,e,s){},bcc2:function(t,e,s){"use strict";s("7029")},cd56:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container d-flex"},[s("Sidebar"),s("div",{staticClass:"main"},[t._m(0),s("div",{staticClass:"tweet-area"},[s("div",{staticClass:"user-avatar"},[s("router-link",{attrs:{to:"/profile"}},[s("img",{staticClass:"avatar",attrs:{src:t._f("nullAvatar")(t.currentUser.avatar),alt:"預設的頭像"}})])],1),s("div",{staticClass:"text-area d-flex flex-column"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tweet,expression:"tweet"}],attrs:{type:"text",placeholder:"有什麼新鮮事？",autofocus:""},domProps:{value:t.tweet},on:{input:function(e){e.target.composing||(t.tweet=e.target.value)}}}),t._v(" "),s("div",{staticClass:"statusbar d-flex align-items-center"},[s("transition",{attrs:{name:"hint"}},[t.tweetHint?s("span",{staticClass:"hint"},[t._v(t._s("empty"===t.tweetHint?"內容不可空白":"字數不可超過 140 字"))]):t._e()]),s("button",{staticClass:"tweet-btn",attrs:{disabled:t.isProcessing,type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.submitTweet.apply(null,arguments)}}},[t._v(" "+t._s(t.isProcessing?"推文中..":"推文")+" ")])],1)])]),s("MainTweetList")],1),s("RightColumn"),s("ReplyModal")],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-header"},[s("span",{staticClass:"title"},[t._v("首頁")])])}],n=s("1da1"),r=s("5530"),o=(s("96cf"),s("d9e2"),s("5ea5")),c=s("dc59"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweet-list",class:{loading:t.isLoading}},[t.isLoading?t._l(6,(function(e){return s("div",{key:e,staticClass:"tweet-item"},[s("SkeletonScreen",{staticClass:"user-avatar",attrs:{isLoading:t.isLoading,skeleton:"div",skeletonLength:0}}),s("div",{staticClass:"post-content d-flex flex-column"},[s("div",{staticClass:"user-info"},[s("SkeletonScreen",{staticClass:"user-name",attrs:{isLoading:t.isLoading,skeleton:"div",skeletonLength:6}}),s("SkeletonScreen",{staticClass:"user-accountName",attrs:{isLoading:t.isLoading,skeleton:"div",skeletonLength:3}}),t._v("‧"),s("SkeletonScreen",{staticClass:"post-time",attrs:{isLoading:t.isLoading,skeleton:"div",skeletonLength:2}})],1),s("SkeletonScreen",{staticClass:"tweet-content",attrs:{isLoading:t.isLoading,skeleton:"div",skeletonLine:2}}),s("div",{staticClass:"icon-item"},[s("span",{staticClass:"reply d-flex"},[s("SkeletonScreen",{attrs:{isLoading:t.isLoading,skeleton:"span",skeletonLength:1}}),s("SkeletonScreen",{staticClass:"replay-count",attrs:{isLoading:t.isLoading,skeleton:"span",skeletonLength:1}})],1),s("div",{staticClass:"like-item"},[s("span",{staticClass:"like d-flex"},[s("SkeletonScreen",{attrs:{isLoading:t.isLoading,skeleton:"span",skeletonLength:1}}),s("SkeletonScreen",{staticClass:"like-count",attrs:{isLoading:t.isLoading,skeleton:"span",skeletonLength:1}})],1)])])],1)],1)})):t._e(),s("transition-group",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],attrs:{name:"tweet"}},t._l(t.tweets,(function(e){return s("div",{key:e.id,staticClass:"tweet-item"},[s("div",{staticClass:"user-avatar"},[s("router-link",{attrs:{to:{path:"/users/"+e.userId}}},[s("img",{attrs:{src:t._f("nullAvatar")(e.User.avatar),alt:"/"}})])],1),s("div",{staticClass:"post-content d-flex flex-column"},[s("router-link",{attrs:{to:{path:"/users/"+e.userId}}},[s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[t._v(t._s(e.User.name))]),s("div",{staticClass:"user-accountName"},[t._v(t._s(e.User.account))]),s("div",{staticClass:"post-time"},[t._v("‧"+t._s(t._f("fromNow")(e.createdAt)))])])]),s("router-link",{staticClass:"tweet-content",attrs:{to:{path:"/tweets/"+e.id}}},[s("span",{staticClass:"tweet-content"},[t._v(" "+t._s(e.description)+" ")])]),s("div",{staticClass:"icon-item"},[s("button",{staticClass:"reply d-flex",on:{click:function(s){return t.$bus.$emit("replyModal",e.id)}}},[s("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M8.77881 1.40127L6.18631 1.39502H6.18506C3.45131 1.39502 1.31006 3.53689 1.31006 6.27127C1.31006 8.83252 3.30131 10.775 5.97568 10.8775V13.27C5.97568 13.3375 6.00318 13.4488 6.05068 13.5219C6.13943 13.6625 6.29068 13.7388 6.44568 13.7388C6.53193 13.7388 6.61881 13.715 6.69693 13.665C6.86193 13.56 10.7426 11.0775 11.7519 10.2238C12.9407 9.21752 13.6519 7.74252 13.6538 6.27877V6.26814C13.6501 3.53877 11.5101 1.40127 8.77881 1.40064V1.40127ZM11.1457 9.50877C10.4369 10.1088 8.10693 11.6369 6.91318 12.4106V10.4188C6.91318 10.16 6.70381 9.95002 6.44443 9.95002H6.19693C3.90943 9.95002 2.24818 8.40252 2.24818 6.27127C2.24818 4.06252 3.97818 2.33252 6.18568 2.33252L8.77756 2.33877H8.77881C10.9863 2.33877 12.7163 4.06752 12.7176 6.27377C12.7157 7.46752 12.1288 8.67627 11.1463 9.50877H11.1457Z",fill:"#657786"}})]),s("span",{staticClass:"replay-count"},[t._v(t._s(e.replyCount))])]),s("div",{staticClass:"like-item"},[s("button",{staticClass:"like d-flex",attrs:{disabled:e.isProcessing},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.toggleLike(e)}}},[s("svg",{directives:[{name:"show",rawName:"v-show",value:!e.isLiked,expression:"!tweet.isLiked"}],attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M7.5 13.5236H7.49125C5.87687 13.4936 1.21875 9.28489 1.21875 5.29864C1.21875 3.38364 2.79687 1.70239 4.59562 1.70239C6.02687 1.70239 6.98937 2.68989 7.49937 3.40864C8.00812 2.69114 8.97062 1.70239 10.4025 1.70239C12.2025 1.70239 13.78 3.38364 13.78 5.29927C13.78 9.28427 9.12125 13.493 7.50687 13.5224H7.5V13.5236ZM4.59625 2.64052C3.29625 2.64052 2.15687 3.88302 2.15687 5.29989C2.15687 8.88739 6.55312 12.5474 7.50062 12.5861C8.44937 12.5474 12.8444 8.88802 12.8444 5.29989C12.8444 3.88302 11.705 2.64052 10.405 2.64052C8.825 2.64052 7.9425 4.47552 7.935 4.49364C7.79125 4.84489 7.2125 4.84489 7.06812 4.49364C7.05937 4.47489 6.1775 2.64052 4.59687 2.64052H4.59625Z",fill:"#657786"}})]),s("transition",{attrs:{name:"heartbeat"}},[s("svg",{directives:[{name:"show",rawName:"v-show",value:e.isLiked,expression:"tweet.isLiked"}],key:"heartbeat",attrs:{width:"22",height:"20",viewBox:"0 0 22 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M11 19.6381H10.986C8.40295 19.5901 0.949951 12.8561 0.949951 6.47812C0.949951 3.41412 3.47495 0.724121 6.35295 0.724121C8.64295 0.724121 10.183 2.30412 10.999 3.45412C11.813 2.30612 13.353 0.724121 15.644 0.724121C18.524 0.724121 21.048 3.41412 21.048 6.47912C21.048 12.8551 13.594 19.5891 11.011 19.6361H11V19.6381Z",fill:"#E0245E"}})])]),s("transition",{attrs:{name:"fall"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!e.isLiked,expression:"!tweet.isLiked"}],key:"fall",staticClass:"like-count"},[t._v(t._s(e.likeCount))])]),s("transition",{attrs:{name:"rise"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.isLiked,expression:"tweet.isLiked"}],key:"rise",staticClass:"like-count"},[t._v(t._s(e.likeCount))])])],1)])])],1)])})),0),t.isLoading?s("Spinner"):t._e()],2)},u=[],d=(s("d81d"),s("51d0")),w=s("2708"),v=s("2375"),g=s("bed1"),p={components:{Spinner:v["a"],SkeletonScreen:g["a"]},mixins:[w["a"],w["c"]],data:function(){return{isLoading:!0,tweets:[]}},created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,d["a"].getTweets();case 4:if(s=e.sent,a=s.data,"error"!==a.status){e.next=8;break}throw new Error(a.message);case 8:t.tweets=a.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{isProcessing:!1})})),t.isLoading=!1,e.next=17;break;case 12:e.prev=12,e.t0=e["catch"](1),t.isLoading=!1,console.log(e.t0),t.$bus.$emit("toast",{icon:"error",title:"".concat(e.t0)});case 17:case"end":return e.stop()}}),e,null,[[1,12]])})))()},toggleLike:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a,i,n,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(t.isProcessing=!0,s.prev=1,t.isLiked){s.next=14;break}return s.next=5,d["a"].addLike(t.id);case 5:if(a=s.sent,i=a.data,"success"===i.status){s.next=9;break}throw new Error(i.message);case 9:t.isLiked=!t.isLiked,t.likeCount+=1,t.isProcessing=!1,s.next=23;break;case 14:return s.next=16,d["a"].deleteLike(t.id);case 16:if(n=s.sent,r=n.data,"success"===r.status){s.next=20;break}throw new Error(r.message);case 20:t.isLiked=!t.isLiked,t.likeCount-=1,t.isProcessing=!1;case 23:s.next=31;break;case 25:s.prev=25,s.t0=s["catch"](1),t.isProcessing=!1,console.log(s.t0),e.fetchTweets(),e.$bus.$emit("toast",{icon:"error",title:"".concat(s.t0)});case 31:case"end":return s.stop()}}),s,null,[[1,25]])})))()}},beforeMount:function(){var t=this;this.$bus.$on("fetch-MainTweetList",(function(){t.fetchTweets()}))}},k=p,m=(s("a95e"),s("2877")),C=Object(m["a"])(k,l,u,!1,null,"7c854e72",null),f=C.exports,h=s("2f62"),L=s("7482"),b=s("2797"),x={mixins:[w["c"]],data:function(){return{tweet:"",isProcessing:!1,tweetHint:!1}},components:{Sidebar:o["a"],RightColumn:c["a"],MainTweetList:f,ReplyModal:b["a"]},computed:Object(r["a"])({},Object(h["b"])(["currentUser"])),methods:{submitTweet:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.tweet){e.next=5;break}return t.tweetHint="empty",t.$bus.$emit("toast",{icon:"error",title:"內容不可空白"}),e.abrupt("return");case 5:if(!(t.tweet.length>=140)){e.next=9;break}return t.tweetHint=!0,t.$bus.$emit("toast",{icon:"error",title:"字數不可超過 140 字"}),e.abrupt("return");case 9:return t.isProcessing=!0,e.next=12,L["a"].submitTweet({description:t.tweet});case 12:if(s=e.sent,a=s.data,console.log(a),"success"!==a.status){e.next=22;break}t.tweet="",t.$bus.$emit("fetch-MainTweetList",!0),t.$bus.$emit("toast",{icon:"success",title:"推文發送成功"}),t.isProcessing=!1,e.next=23;break;case 22:throw new Error(a.message);case 23:e.next=30;break;case 25:e.prev=25,e.t0=e["catch"](0),console.log(e.t0),t.isProcessing=!1,t.$bus.$emit("toast",{icon:"error",title:"".concat(e.t0)});case 30:case"end":return e.stop()}}),e,null,[[0,25]])})))()}},watch:{tweet:function(t){t.length>=140?this.tweetHint=!0:this.tweetHint=!1}}},_=x,S=(s("bcc2"),Object(m["a"])(_,a,i,!1,null,"58adb112",null));e["default"]=S.exports}}]);
//# sourceMappingURL=chunk-50238fec.13347609.js.map
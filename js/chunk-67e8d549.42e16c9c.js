(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67e8d549"],{"00b4":function(t,e,s){"use strict";s("ac1f");var i=s("23e7"),a=s("da84"),n=s("c65b"),r=s("e330"),o=s("1626"),c=s("861d"),m=function(){var t=!1,e=/[ac]/;return e.exec=function(){return t=!0,/./.exec.apply(this,arguments)},!0===e.test("abc")&&t}(),u=a.Error,l=r(/./.test);i({target:"RegExp",proto:!0,forced:!m},{test:function(t){var e=this.exec;if(!o(e))return l(this,t);var s=n(e,this,t);if(null!==s&&!c(s))throw new u("RegExp exec method returned something other than an Object or null");return!!s}})},"714e":function(t,e,s){"use strict";s("ec6f")},ce99:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"setting-container"},[s("Sidebar"),s("form",{staticClass:"setting-form",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t._m(0),s("div",{staticClass:"form-area"},[s("div",{staticClass:"form-row d-flex flex-column",class:{invalid:t.accountHint,"is-loading":t.isLoading,"is-processing":t.isProcessing}},[s("label",{attrs:{for:"account"}},[t._v("帳號")]),s("div",{staticClass:"d-flex"},[s("span",[t._v("@")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.account,expression:"account",modifiers:{trim:!0}}],attrs:{id:"account",type:"text",disabled:t.isLoading||t.isProcessing},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("transition",{attrs:{name:"hint"}},[t.accountHint?s("p",{staticClass:"error-hint",attrs:{id:"account"}},[t._v(" "+t._s("empty"===t.accountHint?"帳號不能空白，請填入想更改的帳號":"Account 已經有人使用")+" ")]):t._e()])],1),s("div",{staticClass:"form-row d-flex flex-column",class:{invalid:t.nameHint,"is-loading":t.isLoading,"is-processing":t.isProcessing}},[s("label",{attrs:{for:"name"}},[t._v("名稱")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],attrs:{type:"text",id:"name",disabled:t.isLoading||t.isProcessing},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("transition",{attrs:{name:"hint"}},[t.nameHint?s("p",{staticClass:"error-hint"},[t._v("字數超出上限！")]):t._e()]),s("transition",{attrs:{name:"hint"}},[t.nameCount?s("p",[t._v(t._s(t.nameCount)+"/50")]):t._e()])],1),s("div",{staticClass:"form-row d-flex flex-column",class:{invalid:t.emailHint,"is-loading":t.isLoading,"is-processing":t.isProcessing}},[s("label",{attrs:{for:"email"}},[t._v("Email")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.email,expression:"email",modifiers:{trim:!0}}],staticClass:"email",attrs:{type:"email",id:"email",disabled:t.isLoading||t.isProcessing},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("transition",{attrs:{name:"hint"}},[t.emailHint?s("p",{staticClass:"error-hint"},[t._v(" "+t._s("empty"===t.emailHint?"Email不能空白，請填入想更改的 Email":"Email 已經有人使用")+" ")]):t._e()]),s("transition",{attrs:{name:"hint"}},[t.emailCheck?s("div",{staticClass:"hint d-flex align-items-center"},[s("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"}},[s("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}})]),t._v("  輸入的Email 符合格式 ")]):t._e()])],1),s("div",{staticClass:"form-row d-flex flex-column",class:{invalid:t.passwordHint,"is-loading":t.isLoading,"is-processing":t.isProcessing}},[s("label",{attrs:{for:"password"}},[t._v("密碼")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"password",id:"password",disabled:t.isLoading||t.isProcessing},domProps:{value:t.password},on:{blur:[t.passwordLength,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.password=e.target.value.trim())}}}),s("transition",{attrs:{name:"hint"}},[t.passwordHint?s("p",{staticClass:"error-hint"},[t._v("密碼至少要有４個字")]):t._e()])],1),s("div",{staticClass:"form-row d-flex flex-column",class:{invalid:t.checkHint,"is-loading":t.isLoading,"is-processing":t.isProcessing}},[s("label",{attrs:{for:"passwordCheck"}},[t._v("密碼確認")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.passwordCheck,expression:"passwordCheck",modifiers:{trim:!0}}],attrs:{type:"password",id:"passwordCheck",disabled:t.isLoading||t.isProcessing},domProps:{value:t.passwordCheck},on:{blur:[t.checkPassword,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.passwordCheck=e.target.value.trim())}}}),s("transition",{attrs:{name:"hint"}},[t.checkHint?s("p",{staticClass:"error-hint"},[t._v("密碼確認錯誤！")]):t._e()])],1),s("div",{staticClass:"footer"},[s("transition",{attrs:{name:"fade"}},[t.modify?s("button",{staticClass:"restore",attrs:{type:"button",disabled:t.isProcessing},on:{click:t.restore}},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"512",height:"512"}},[s("path",{attrs:{d:"M12,0A11.972,11.972,0,0,0,4,3.073V1A1,1,0,0,0,2,1V4A3,3,0,0,0,5,7H8A1,1,0,0,0,8,5H5a.854.854,0,0,1-.1-.021A9.987,9.987,0,1,1,2,12a1,1,0,0,0-2,0A12,12,0,1,0,12,0Z"}}),s("path",{attrs:{d:"M12,6a1,1,0,0,0-1,1v5a1,1,0,0,0,.293.707l3,3a1,1,0,0,0,1.414-1.414L13,11.586V7A1,1,0,0,0,12,6Z"}})]),t._v(" 回復設定 ")]):t._e()]),s("button",{staticClass:"save",attrs:{type:"submit",disabled:t.isProcessing},on:{mouseenter:t.saveHint}},[t.isProcessing?s("Spinner"):t._e(),t._v(" "+t._s(t.isProcessing?"儲存中..":"儲存")+" ")],1)],1)])])],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-header"},[s("h2",{staticClass:"title"},[t._v("帳戶設定")])])}],n=s("1da1"),r=(s("96cf"),s("b0c0"),s("ac1f"),s("466d"),s("00b4"),s("d9e2"),s("5ea5")),o=s("2375"),c=s("1602"),m={components:{Sidebar:r["a"],Spinner:o["a"]},data:function(){return{isLoading:!0,account:"",accountHint:!1,name:"",nameHint:!1,email:"",emailInit:"",emailHint:!1,emailCheck:!1,password:"",passwordHint:!1,passwordCheck:"",checkHint:!1,modify:!1,isProcessing:!1}},computed:{nameCount:function(){return this.name.length>50?this.nameHint=!0:this.nameHint=!1,this.name.length}},watch:{account:function(t){this.accountHint=!t&&"empty",t!==this.$store.state.currentUser.account?this.modify=!0:this.modify=!1},name:function(t){t!==this.$store.state.currentUser.name?this.modify=!0:this.modify=!1},email:function(t){this.emailHint=!t&&"empty",t.match(/[^@\s]+@[^@\s]+\.[^@\s]+/)?this.emailCheck=!0:this.emailCheck=!1,t!==this.emailInit?this.modify=!0:this.modify=!1},password:function(t,e){t!==e&&(this.passwordHint=!1)},passwordCheck:function(t,e){t!==e&&(this.checkHint=!1)}},created:function(){this.fetchAccount()},methods:{passwordLength:function(){this.password&&this.password.length<4?this.passwordHint=!0:this.passwordHint=!1},checkPassword:function(){this.passwordCheck&&this.password!==this.passwordCheck?this.checkHint=!0:this.checkHint=!1},fetchAccount:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,i,a,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,c["a"].getCurrent();case 4:s=e.sent,i=s.data,"success"!==i.status&&t.$bus.$emit("toast",{icon:"error",title:"無法取得資料"}),a=i.data,n=a.account,r=a.name,o=a.email,t.account=n,t.name=r,t.email=o,t.emailInit=o,e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),console.log(e.t0),t.$bus.$emit({title:"".concat(e.t0)});case 18:return e.prev=18,t.isLoading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})))()},handleSubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.modify||t.password){e.next=3;break}return t.$bus.$emit("toast",{icon:"error",title:"你沒有修改任何帳戶資料喔"}),e.abrupt("return");case 3:if(t.account){e.next=6;break}return t.$bus.$emit("toast",{icon:"error",title:"請填入想更改的帳號"}),e.abrupt("return");case 6:if(t.name.length>50&&t.$bus.$emit("toast",{icon:"error",title:"字數超出上限！"}),t.email){e.next=12;break}return t.$bus.$emit("toast",{icon:"error",title:"請填入 Email"}),e.abrupt("return");case 12:if(/[^@\s]+@[^@\s]+\.[^@\s]+/.test(t.email)){e.next=15;break}return t.$bus.$emit("toast",{icon:"error",title:"Email 格式錯誤"}),e.abrupt("return");case 15:if(!(t.password&&t.password.length<4)){e.next=18;break}return t.$bus.$emit("toast",{icon:"error",title:"密碼至少要有四個字"}),e.abrupt("return");case 18:if(!t.password||t.passwordCheck){e.next=23;break}return t.$bus.$emit("toast",{icon:"error",title:"請再次輸入密碼"}),e.abrupt("return");case 23:if(t.password===t.passwordCheck){e.next=26;break}return t.$bus.$emit("toast",{icon:"error",title:"密碼與密碼確認輸入內容不同"}),e.abrupt("return");case 26:return t.isProcessing=!0,e.prev=27,e.next=30,c["a"].editAccount({account:t.account,name:t.name,email:t.email,password:t.password});case 30:if(s=e.sent,i=s.data,"success"===i.status){e.next=34;break}throw new Error(i.message);case 34:t.fetchAccount(),t.$store.dispatch("fetchCurrentUser"),t.$bus.$emit("toast",{icon:"success",title:"資料修改成功"}),t.modify=!1,e.next=44;break;case 40:e.prev=40,e.t0=e["catch"](27),console.log(e.t0),e.t0.message.match(/account/i)&&e.t0.message.match(/required/i)?(t.$bus.$emit("toast",{icon:"error",title:"帳號不能空白"}),t.accountHint="empty"):e.t0.message.match(/暱稱/)&&e.t0.message.match(/上限/)?(t.$bus.$emit("toast",{icon:"error",title:"名稱字數超過上限"}),t.nameHint=!0):e.t0.message.match(/email/i)&&e.t0.message.match(/required/i)?(t.$bus.$emit("toast",{icon:"error",title:"Email 不能空白"}),t.emailHint="empty"):e.t0.message.match(/密碼至少/)?(t.$bus.$emit("toast",{icon:"error",title:"密碼至少要有四個字"}),t.passwordHint=!0):t.$bus.$emit("toast",{icon:"error",title:"".concat(e.t0.message)});case 44:return e.prev=44,t.isProcessing=!1,e.finish(44);case 47:case"end":return e.stop()}}),e,null,[[27,40,44,47]])})))()},restore:function(){this.isLoading=!0,this.account=this.$store.state.currentUser.account,this.name=this.$store.state.currentUser.name,this.email=this.emailInit,this.password="",this.passwordCheck="",this.isLoading=!1},saveHint:function(){this.modify&&this.$bus.$emit("toast",{icon:"success",title:"尚未儲存前，都可以回復原本帳戶資料"})}}},u=m,l=(s("714e"),s("2877")),d=Object(l["a"])(u,i,a,!1,null,"272fe92c",null);e["default"]=d.exports},ec6f:function(t,e,s){}}]);
//# sourceMappingURL=chunk-67e8d549.42e16c9c.js.map